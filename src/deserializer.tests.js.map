{"version":3,"sources":["deserializer.tests.es6"],"names":[],"mappings":"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","file":"deserializer.tests.js","sourcesContent":["import chai from 'chai';\r\nimport chaiThings from 'chai-things';\r\nimport Deserializer from './deserializer';\r\n\r\nchai.should();\r\nconst expect = chai.expect;\r\nchai.use(chaiThings);\r\n\r\ndescribe('Deserializer', () => {\r\n  describe('.deserialize()', () => {\r\n\r\n    it('deserializes empty objects', () => {\r\n      const mockJsonc = {hasTypeName: () => false};\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = {instances: [{__type__: \"__object__\", __value__: {}}], root: [{__index__: 0}]};\r\n      const output = deserializer.deserialize(input);\r\n\r\n      output.should.eql({});\r\n    });\r\n\r\n    it('deserializes string properties', () => {\r\n      const mockJsonc = {hasTypeName: () => false};\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = {instances: [{__type__: \"__object__\", __value__: {a: \"test\"}}], root: [{__index__: 0}]};\r\n      const output = deserializer.deserialize(input);\r\n\r\n      output.should.eql({a: 'test'});\r\n    });\r\n\r\n    it('deserializes boolean properties', () => {\r\n      const mockJsonc = {hasTypeName: () => false};\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = {instances: [{__type__: \"__object__\", __value__: {a: true}}], root: [{__index__: 0}]};\r\n      const output = deserializer.deserialize(input);\r\n\r\n      output.should.eql({a: true});\r\n    });\r\n\r\n    it('deserializes number properties', () => {\r\n      const mockJsonc = {hasTypeName: () => false};\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = {instances: [{__type__: \"__object__\", __value__: {a: 1}}], root: [{__index__: 0}]};\r\n      const output = deserializer.deserialize(input);\r\n\r\n      output.should.eql({a: 1});\r\n    });\r\n\r\n    it('deserializes an Array', () => {\r\n      const mockJsonc = {hasTypeName: () => false};\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = {instances: [{__type__: \"__array__\", __value__: [1, 2]}], root: [{__index__: 0}]};\r\n      const output = deserializer.deserialize(input);\r\n\r\n      output.should.eql([1, 2]);\r\n    });\r\n\r\n    it('deserializes an Array with extra properties', () => {\r\n      const mockJsonc = {hasTypeName: () => false};\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = {\r\n        instances: [{__type__: \"__array__\", __value__: {__array__: [1, 2], __props__: {test: \"123\"}}}],\r\n        root: [{__index__: 0}]\r\n      };\r\n      const output = deserializer.deserialize(input);\r\n\r\n      const array = [1, 2];\r\n      array.test = '123';\r\n      output.should.eql(array);\r\n    });\r\n\r\n    it('deserializes a Map', () => {\r\n      const mockJsonc = { hasTypeName: () => false };\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = { instances: [{ __type__: \"__native_map__\", __value__: [[1, 2]] }], root: [{ __index__: 0 }] };\r\n      const output = deserializer.deserialize(input);\r\n\r\n      output.should.be.an.instanceOf(Map);\r\n      [...output].should.eql([[1, 2]]);\r\n    });\r\n\r\n    it('deserializes an empty Map', () => {\r\n      const mockJsonc = {hasTypeName: () => false};\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = {instances:[{__type__:\"__native_map__\",__value__:[]}],root:[{__index__:0}]};\r\n      const output = deserializer.deserialize(input);\r\n\r\n      output.should.be.an.instanceOf(Map);\r\n    });\r\n\r\n    it('deserializes a Map containing registered types', () => {\r\n      class TestClass {\r\n        static __type__ = 'test';\r\n        test = '123';\r\n      }\r\n\r\n      const mockJsonc = {\r\n        hasTypeName: (type) => type === 'test',\r\n        registry: { test: { type: TestClass } },\r\n        getOptions: ()=>null\r\n      };\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = {instances:[{__type__:\"__native_map__\",__value__:[[\"test\",{__index__:1}],[{__index__:2},\"test\"],[{__index__:3},\"test\"]]},{__type__:\"test\",__value__:{test:\"123\"}},{__type__:\"test\",__value__:{test:\"123\"}},{__type__:\"test\",__value__:{test:\"123\"}}],root:[{__index__:0}]};\r\n      const output = deserializer.deserialize(input);\r\n      output.size.should.equal(3);\r\n      const items = [...output];\r\n      expect(items[0]).to.eql(['test', new TestClass()]);\r\n      expect(items[1]).to.eql([new TestClass(),'test']);\r\n      expect(items[2]).to.eql([new TestClass(),'test']);\r\n    });\r\n\r\n    it('deserializes a Set', () => {\r\n      const mockJsonc = {hasTypeName: () => false};\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = {instances: [{__type__: \"__native_set__\", __value__: [1, 2]}], root: [{__index__: 0}]};\r\n      const output = deserializer.deserialize(input);\r\n\r\n      output.should.be.an.instanceOf(Set);\r\n      [...output].should.eql([1, 2]);\r\n    });\r\n\r\n    it('deserializes nested objects', () => {\r\n      const mockJsonc = {hasTypeName: () => false};\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = {\r\n        instances: [{\r\n          __type__: \"__object__\",\r\n          __value__: {a: 1, b: {__index__: 1}}\r\n        }, {__type__: \"__object__\", __value__: {c: \"test\"}}], root: [{__index__: 0}]\r\n      };\r\n      const output = deserializer.deserialize(input);\r\n\r\n      output.should.eql({a: 1, b: {c: 'test'}});\r\n    });\r\n\r\n    it('deserializes object references to the same object instance', () => {\r\n      const mockJsonc = {hasTypeName: () => false};\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = {\r\n        instances: [{\r\n          __type__: \"__array__\",\r\n          __value__: [{__index__: 1}, {__index__: 1}, {__index__: 1}]\r\n        }, {__type__: \"__object__\", __value__: {}}], root: [{__index__: 0}]\r\n      };\r\n      const output = deserializer.deserialize(input);\r\n\r\n      const obj = output[0];\r\n      output.should.all.equal(obj);\r\n    });\r\n\r\n    it('deserializes registered types', () => {\r\n      class TestClass {\r\n        static __type__ = 'test';\r\n        test = '123';\r\n      }\r\n\r\n      const mockJsonc = {hasTypeName: () => true, registry: {test: {type: TestClass}}};\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = {instances: [{__type__: \"test\", __value__: {test: \"123\"}}], root: [{__index__: 0}]};\r\n      const output = deserializer.deserialize(input);\r\n\r\n      output.should.be.an.instanceOf(TestClass);\r\n      expect(output.test).to.equal('123');\r\n    });\r\n\r\n    it('deserializes registered types that extend Array', () => {\r\n      class TestClass extends Array {\r\n        static __type__ = 'test';\r\n        test = '123';\r\n      }\r\n      const obj = new TestClass();\r\n      obj.push(1);\r\n      obj.push(2);\r\n\r\n      const mockJsonc = {hasTypeName: () => true, registry: {test: {type: TestClass}}};\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = {\r\n        instances: [{__type__: \"test\", __value__: {__array__: [1, 2], __props__: {test: \"123\"}}}],\r\n        root: [{__index__: 0}]\r\n      };\r\n      const output = deserializer.deserialize(input);\r\n\r\n      expect(output).to.be.an.instanceOf(TestClass);\r\n      expect(output.test).to.equal('123');\r\n      expect(output[0]).to.equal(1);\r\n      expect(output[1]).to.equal(2);\r\n    });\r\n\r\n    it('deserializes registered functions', () => {\r\n      function testFunction() {\r\n        return 'hello world';\r\n      }\r\n\r\n      const mockJsonc = {fnReverseRegistry: new Map([['test', testFunction]])};\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = {instances: [], root: [{__fn__: \"test\"}]};\r\n      const output = deserializer.deserialize(input);\r\n      expect(output).to.equal(testFunction);\r\n    });\r\n\r\n    it('deserializes registered functions of registered types', () => {\r\n      class TestClass {\r\n        static __type__ = 'test';\r\n        test = '123';\r\n\r\n        testFunction() {\r\n\r\n        }\r\n      }\r\n\r\n      const mockJsonc = {\r\n        hasTypeName: (typeName) => typeName === 'test',\r\n        registry: {test: {type: TestClass}},\r\n        fnReverseRegistry: new Map([['test.test', TestClass.prototype.testFunction]])\r\n      };\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = {instances:[{__type__:\"__object__\",__value__:{obj:{__index__:1},test:{__fn__:\"test.test\"}}},{__type__:\"test\",__value__:{test:\"123\"}}],root:[{__index__:0}]};\r\n      const output = deserializer.deserialize(input);\r\n\r\n      expect(output.test).to.equal(TestClass.prototype.testFunction);\r\n      expect(output.obj).to.be.an.instanceOf(TestClass);\r\n      expect(output.obj.test).to.equal('123');\r\n    });\r\n\r\n    it('allows post-processing of registered types via the Deserializer.Symbols.PostProcess property', () => {\r\n      class TestClass {\r\n        static __type__ = 'test';\r\n        test = '123';\r\n\r\n        [Deserializer.Symbols.PostProcess]() {\r\n          this.test = 'cats!';\r\n        }\r\n      }\r\n\r\n      const mockJsonc = {hasTypeName: () => true, registry: {test: {type: TestClass}}};\r\n      const deserializer = new Deserializer(mockJsonc);\r\n      const input = {instances: [{__type__: \"test\", __value__: {test: \"123\"}}], root: [{__index__: 0}]};\r\n      const output = deserializer.deserialize(input);\r\n\r\n      output.test.should.equal('cats!');\r\n    });\r\n\r\n  });\r\n});\r\n"]}